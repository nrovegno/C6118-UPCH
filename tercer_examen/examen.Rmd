---
title: "Análisis de las condiciones del océano frente a Perú durante mi primer año de vida"
author: "Nicolás Rovegno Arrese"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ncdf4)
library(fields)
#install.packages("devtools")
#devtools::install_github("roliveros-ramos/kali")
library(kali)
```

```{r variables, echo = FALSE}
#variables sst
nc_sst = nc_open("datos/sst.nc4") 
sst_var = ncvar_get(nc_sst, names(nc_sst$var))
sst_lat = ncvar_get(nc_sst, "latitude")
sst_lon = ncvar_get(nc_sst, "longitude") - 360

#variables sss
nc_sss = nc_open("datos/sss.nc4") 
sss_var = ncvar_get(nc_sss, names(nc_sss$var))
sss_lat = ncvar_get(nc_sss, "latitude")
sss_lon = ncvar_get(nc_sss, "longitude") - 360

#variables ph
nc_ph = nc_open("datos/ph.nc4") 
ph_var = ncvar_get(nc_ph, names(nc_ph$var))
ph_lat = ncvar_get(nc_ph, "latitude")
ph_lon = ncvar_get(nc_ph, "longitude") - 360
log_ph=abs(log10(ph_var))

#variables sphy
nc_sphy = nc_open("datos/sphy.nc4") 
sphy_var = ncvar_get(nc_sphy, names(nc_sphy$var))
sphy_lat = ncvar_get(nc_sphy, "latitude")
spy_lon = ncvar_get(nc_sphy, "longitude") - 360
sphy_var2=sphy_var*10^6 #micromolar

#variables lphy
nc_lphy = nc_open("datos/lphy.nc4") 
lphy_var = ncvar_get(nc_lphy, names(nc_lphy$var))
lphy_lat = ncvar_get(nc_lphy, "latitude")
lphy_lon = ncvar_get(nc_lphy, "longitude") - 360
lphy_var2=lphy_var*10^6 #micromolar

#variable tphy - total plancton
tphy_var=lphy_var+sphy_var
tphy2=tphy_var*10^6 #micromolar

```


## Introducción
El presente reporte constituye la evaluación final del curso de Programación Científica del Programa de Maestría en Ciencias del Mar 2016-I. Como objetivo de dicho reporte se ha realizado el análisis de las condiciones oceanográficas frente al Perú durante el año 1991. Se ha pla
 
## Materiales y métodos
Se utilizaron bases de datos (fuentes) de las siguientes variables...

- Promedio TSM 1959-2005
- ATSM año de estudio

## Resultados y discusión

```{r funciones, echo = FALSE}

#función anomalías
anho_1991=c(385:396)
Anom_1991 = function (var_nc, var_nom, var_lab){
var_mean=apply(var_nc[,,], MARGIN = c(1,2), FUN = mean, na.rm = TRUE)
var_1991=apply(var_nc[,,anho_1991], MARGIN = c(1,2), FUN = mean, na.rm = TRUE)
anom_var=var_mean-var_1991
image.map(sst_lon, sst_lat, anom_var, main = paste("Anomalía de", var_nom,
"durante 1991", sep =" "), legend.lab = var_lab)
}
```

```{r graficos, echo = FALSE, fig.width=4, fig.height=4}
Anom_1991(sst_var, "temperatura", "ATSM")
Anom_1991(sss_var, "salinidad", "ASSS")


```

De acuerdo al ONI (3.4) el año 1991 fue categorizado como El Niño, sin embargo de acuerdo al ICEN (1+2) fue un año neutro

```{r, ninho, echo=FALSE}
ONI=c(0.4, 0.3, 0.2, 0.2, 0.4, 0.6, 0.7, 0.7, 0.7, 0.8, 1.2, 1.4)
ICEN=c(-0.65, -0.47, -0.39, -0.21, -0.08, 0.21, 0.30, 0.35, 0.39, 0.48, 0.61, 0.55)
months=(month.abb)
Tabla=data.frame(months, ONI, ICEN) #Fuente IGP, NOAA
Tabla
```




## Conclusiones
Año con tendencia fría, sss igual


## Referencias

